      module heg_mod
      integer :: dim_heg,
     &	       n_d_heg,
     &	       n_k_as1,
     &	       n_k_fermi,
     &	       n_k_fermi_c,
     &	       n_kl_fermi,
     &	       n_kl_fermi_c,
     &	       n_k_heg,
     &	       n_p_heg,
     &	       n_p_fermi,
     &	       n_phi_heg,
     &	       n_q_heg,
     &	       n_q_rest,
     &	       n_r_heg,
     &           n_sig_k_heg_pade,
     &           n_w_q_heg_pade,
     &	       n_x_heg,
     &           nq_sph_c,
     &           nr_div(3),
     &           nr_div_c(3),
     &           nr_full_c,
     &           nrr_div,
     &           nrr_div_c,
     &           nstar_c
      real*8 :: alf_k_heg,
     &	      b_split_heg,
     &	      bet_q_ad,
     &	      chem_pot_heg_0,
     &          d_infinum,
     &	      e_p0_v0_heg,
     &	      e_p0_w0_nu,
     &	      e_p0_w0_tau,
     &	      e_sc0_g0_heg_omega,
     &	      e_sc0_g0_heg_tau,
     &	      e_sx0_g0_heg,
     &	      eta_heg,
     &	      ex_heg,
     &	      exc_heg(2),
     &	      k_b_zone,
     &	      k_fermi,
     &          k_inf,
     &          k_infinum,
     &          nu_plasmon,
     &          p_infinum,
     &          q_infinum,
     &          q_small_heg,
     &          q0b0_c(3,3),
     &          r_infinum,
     &          r0b0_c(3,3),
     &	      ro_el_gas,
     &          ro_spin(2),
     &          rs_el_gas,
     &	      tkin_dens_heg,
     &	      tkin0_dens_heg,
     &	      step_d_x,
     &	      step_k_x,
     &	      step_k_x2,
     &	      step_p_x,
     &	      step_phi_x,
     &	      step_q_x,
     &	      step_r_x,
     &	      step_x_x,
     &	      step_x0_x,
     &	      theta_heg(2,2),
     &	      vol_bz_heg,
     &	      vxc_heg(2),
     &          x_d_infinum,
     &          x_fermi,
     &          x_k_infinum,
     &          x_p_infinum,
     &          x_q_infinum,
     &          x_q_singular,
     &          x_qk_infinum,
     &          x_r_infinum
      integer, allocatable :: indstar_c(:),
     &                        n_mpi_k_heg(:),
     &	                    n_mpi_r_heg(:),
     &	                    n_mpi_q_heg(:),
     &	                    ndim_k_heg(:),
     &	                    ndim_q_heg(:),
     &                        ndim_r_heg(:),
     &                        nu_vert_lim(:,:),
     &                        q_cube_in_sph_c(:),
     &                        q_sph_in_cube_c(:)
      real*8, allocatable :: bz_heg_bound(:),
     &                       conv_ladder(:,:),
     &                       d_mesh_heg(:),
     &                       d2sigx_dk2_heg(:),
     &                       df_q_nu_heg(:,:),
     &                       dg_k_tau_heg(:,:,:),
     &                       dg_k_tau_heg_c(:,:,:),
     &                       dg_k_tau_spl(:,:,:,:),
     &                       dg_r_tau_heg(:,:,:),
     &                       dgc_k_tau_heg(:,:,:),
     &                       dgx_k_tau_heg(:,:,:),
     &                       dk_from_r_heg_sing(:,:),
     &                       dp_q_tau_heg(:),
     &                       dsigc_k_tau_heg(:,:,:),
     &                       dsigx_dk_heg(:,:),
     &                       dw_q_tau_heg(:),
     &                       e_qp_heg(:,:),
     &                       e_star_free(:,:),
     &                       e_star_qp(:,:),
     &                       e_star_x(:,:),
     &                       e_star_xc(:,:),
     &                       e_x_heg(:,:),
     &                       e1_heg(:,:),
     &                       edc_q_nu_heg(:,:,:),
     &                       edd_q_nu_heg(:,:),
     &                       el_hole_as_nu_par(:,:),
     &                       el_hole_nu_at_small_q(:,:),
     &                       el_hole_q_nu_heg(:,:),
     &                       eps0_q_nu_heg(:,:),
     &                       eps_q_nu_heg(:,:),
     &                       eps_q_tau_heg(:,:),
     &                       epsinv_q_nu_heg(:,:),
     &                       epsinv0_as_q_nu_heg(:,:),
     &                       epsinv0_q_nu_heg(:,:),
     &                       dwtau_dq_heg(:,:),
     &                       f_xc(:,:),
     &                       f_xc_zz(:,:),
     &                       g_fac_a(:,:),
     &                       g_fac_n(:,:),
     &                       g_fac_s(:,:),
     &                       g_heg_pw(:,:,:,:),
     &                       g_k_tau_heg(:,:,:),
     &                       g_k_tau_heg_c(:,:,:),
     &                       g_k_tau_spl(:,:,:,:),
     &                       g_qp_k_tau_heg(:,:,:,:),
     &                       g_r_tau_heg(:,:,:),
     &                       g_r_tau_heg_c(:,:,:),
     &                       g_low_r_tau_heg(:,:,:,:),
     &                       g0_k_tau_heg(:,:),
     &                       g0_r_tau_heg(:,:,:,:),
     &                       g3_r_tau_heg(:,:,:),
     &                       gc_as_om_par(:,:,:),
     &                       gc_k_tau_heg(:,:,:),
     &                       gc_k_tau_spl(:,:,:,:),
     &                       gsig_k_tau_heg(:,:,:),
     &                       gsig_k_tau_spl(:,:,:,:),
     &                       gx_k_tau_heg(:,:,:),
     &                       gx_k_tau_heg_c(:,:,:),
     &                       heg_matr_0(:,:,:),
     &                       k_asym_heg(:,:),
     &                       k_mesh_as1(:),
     &                       k_m_heg(:),
     &                       k_to_r(:,:),
     &                       k_w_heg(:),
     &                       lff_heg(:,:),
     &                       matr_g_g(:,:,:,:,:),
     &                       matr_p_gg(:,:,:),
     &                       matr_q(:,:,:),
     &                       matr_sigc_gw(:,:,:),
     &                       matr_sigx_g(:,:),
     &                       matr_vrt_dyn(:,:,:),
     &                       matr_vrt_sig(:,:,:,:),
     &                       matr_vrt_stat(:,:),
     &                       p_as_nu_par(:,:),
     &                       p_heg_pw(:,:,:),
     &                       p_loc_nu_heg(:,:,:,:),
     &                       p_loc_tau_heg(:,:,:,:),
     &                       p_low_q_nu_heg(:,:),
     &                       p_low_q_tau_heg(:,:),
     &                       p_low_r_tau_heg(:,:),
     &                       p_m_heg(:),
     &                       p_q_nu_heg(:,:),
     &                       p_q_nu_vertex_heg(:,:),
     &                       p_q_nu_vertex_rad(:,:),
     &                       p_q_tau_heg(:,:),
     &                       p_q_tau_vertex_heg(:,:),
     &                       p_small_q_nu_heg(:),
     &                       p_w_heg(:),
     &                       p_wi_as_nu_par(:,:),
     &                       p_wi_nu_at_small_q(:,:),
     &                       p_wi_q_nu_heg(:,:),
     &                       p_wi_q_tau_heg(:,:),
     &                       p0_as_nu_par(:,:),
     &                       p0_as_q_nu_heg(:,:),
     &                       p0_as_q_tau_heg(:,:),
     &                       p0_inf_as_nu_par(:,:),
     &                       p0_q_nu_heg(:,:),
     &                       p0_q_tau_heg(:,:),
     &                       p0_r_tau_heg(:,:),
     &                       p1_q_nu_heg(:,:),
     &                       p1_q_tau_heg(:,:),
     &                       p1_r_tau_heg(:,:),
     &                       pdc_q_nu_heg(:,:,:),
     &                       pdc_q_tau_heg(:,:,:),
     &                       phi_heg(:,:,:),
     &                       phi_m_heg(:),
     &                       phi_w_heg(:),
     &                       psi_heg(:,:,:),
     &                       psi_j_heg(:,:,:),
     &                       psi_phi_phi_heg(:,:,:),
     &                       q_irr(:,:),
     &                       q_irr_c(:,:),
     &                       q_m_heg(:),
     &                       q_mesh_heg(:,:),
     &                       q_mesh_heg_c(:,:),
     &                       q_to_r(:,:),
     &                       q_w_heg(:),
     &                       q_sph(:,:),
     &                       q_sph_c(:,:),
     &                       qabs_line(:),
     &                       qabs_line_c(:),
     &                       qabs_star(:),
     &                       qabs_star_c(:),
     &                       qc_line(:,:),
     &                       r_m_heg(:),
     &                       r_mesh_heg(:,:),
     &                       r_mesh_heg_c(:,:),
     &                       r_to_k(:,:),
     &                       r_to_q(:,:),
     &                       r_w_heg(:),
     &                       resp0_as_q_nu_heg(:,:),
     &                       resp0_as_q_tau_heg(:,:),
     &                       resp0_inf_as_nu_par(:,:),
     &                       resp0_q0_coeff(:,:),
     &                       resp_as_nu_par(:,:),
     &                       resp_line_heg(:,:),
     &                       resp_q_nu_heg(:,:),
     &                       resp_q_tau_heg(:,:),
     &                       resp_q0_coeff(:,:),
     &                       resp_r_tau_heg(:,:),
     &                       resp_zz_line_heg(:,:),
     &                       resp0_q_nu_heg(:,:),
     &                       resp0_q_tau_heg(:,:),
     &                       resp0_r_tau_heg(:,:),
     &                       sig_0_heg(:,:),
     &                       sigc_as_om_par(:,:,:),
     &                       sigc_heg_pw(:,:,:,:),
     &                       sigc_gw_k_tau_heg(:,:,:,:),
     &                       sigc_hf_k_tau_heg(:,:,:,:),
     &                       sigc_j1(:,:,:),
     &                       sigc_j2(:,:,:),
     &                       sigc_k1(:,:,:),
     &                       sigc_k2(:,:,:),
     &                       sigc_k_tau_heg(:,:,:),
     &                       sigc_k_tau_heg_c(:,:,:),
     &                       sigc_k_tau_heg_old(:,:,:),
     &                       sigc0_k_tau_heg(:,:,:),
     &                       sig_k_tau_vertex_heg(:,:,:),
     &                       sig_k_tau_vertex_rad(:,:,:),
     &                       sigc_l1(:,:,:),
     &                       sigc_l2(:,:,:),
     &                       sigc_l3(:,:,:),
     &                       sigc_r_tau_heg(:,:,:,:),
     &                       sigc_vert_k_tau_heg(:,:,:,:),
     &                       sigc_om_at_large_k(:,:,:),
     &                       sigc0_r_tau_heg(:,:,:,:),
     &                       sigx_at_large_k(:),
     &                       sigx_at_small_k(:,:),
     &                       sigx_heg_pw(:,:,:),
     &                       sigx0_as_k_heg(:,:),
     &                       sigx0_k_heg(:,:),
     &                       sigx_k_heg(:,:),
     &                       sigx_k_heg_c(:,:),
     &                       sigx_k_heg_old(:,:),
     &                       sigx_k_heg_r(:),
     &                       sigx_k_heg_pol(:,:),
     &                       sigx_k_spl(:,:,:),
     &                       sigx_old_heg(:,:),
     &                       sigx_r_heg(:,:),
     &                       sigx1_k_heg(:,:),
     &                       sigx1as(:),
     &                       sigx2as(:),
     &                       sigx1main(:,:),
     &                       sigx2main(:),
     &                       spectrum(:),
     &                       spectrum_ac(:),
     &                       step_q_ad(:,:),
     &                       sum_nu_vert(:,:,:),
     &                       sum_nu_vert_asymp(:),
     &                       v_q_heg(:),
     &                       v_q_heg_c(:),
     &                       v_r_heg(:),
     &                       v_r_heg_c(:),
     &                       w_as_nu_par(:,:),
     &                       w_loc_nu_heg(:,:,:,:),
     &                       w_q_nu_heg(:,:),
     &                       w_q_nu_heg_c(:,:),
     &                       w_q_nu_spl(:,:,:),
     &                       w_q_tau_heg(:,:),
     &                       w_q_tau_heg_c(:,:),
     &                       w_r_nu_heg(:,:),
     &                       w_r_tau_heg(:,:),
     &                       w_r_tau_heg_c(:,:),
     &                       w_wi_as_nu_par(:,:),
     &                       w_wi_nu_at_small_q(:,:),
     &                       w_wi_q_nu_heg(:,:),
     &                       w_wi_q_nu_pade(:,:,:),
     &                       w_wi_q_nu_spl(:,:,:),
     &                       w_wi_q_tau_heg(:,:),
     &                       w_wi_r_tau_heg(:,:),
     &                       wc_heg_pw(:,:,:),
     &                       w0_as_nu_par(:,:),
     &                       w0_as_q_nu_heg(:,:),
     &                       w0_as_q_tau_heg(:,:),
     &                       w0_as_r_tau_heg(:,:),
     &                       w0_inf_as_nu_par(:,:),
     &                       w0_q_nu_heg(:,:),
     &                       w0_q_tau_heg(:,:),
     &                       x_m_heg(:),
     &                       x_w_heg(:),
     &                       x_q_k_ad(:,:),
     &                       x_q_inf_ad(:,:),
     &                       x0_m_heg(:),
     &                       x0_w_heg(:),
     &                       z_factor_heg(:,:),
     &                       z_ren_heg(:,:)
      complex*16, allocatable :: delta_gamma(:,:,:,:),
     &                           dsigc_dk_om_heg(:,:,:),
     &                           e1_rax_heg(:,:,:),
     &                           g0_k_om_heg(:,:,:),
     &                           g1_k_om_heg(:,:,:),
     &                           g_k_omega_heg(:,:,:),
     &                           g_k_omega_heg_c(:,:,:),
     &                           g_qp_k_om_heg(:,:,:),
     &                           g_rax_heg(:,:,:),
     &                           gc_k_omega_heg(:,:,:),
     &                           gc_om_at_large_k(:,:,:),
     &                           gsig_k_omega_heg(:,:,:),
     &                           gx_k_omega_heg(:,:,:),
     &                           gx_k_omega_heg_c(:,:,:),
     &                           lambda_dyn_out(:,:,:,:),
     &                           sig_k_omega_spl(:,:,:,:),
     &                           sig_real_heg(:,:,:),
     &                           sigc_as_k_om_heg(:,:,:),
     &                           sigc_gw_k_om_heg(:,:,:),
     &                           sigc_gw_k_omega_spl(:,:,:,:),
     &                           sigc_hf_k_om_heg(:,:,:),
     &                           sigc_k_omega_as(:,:),
     &                           sigc_k_omega_heg(:,:,:),
     &                           sigc_k_omega_heg_c(:,:,:),
     &                           sigc_old_heg(:,:,:),
     &                           sigc_qp_k_omega_heg(:,:,:),
     &                           sigc0_k_omega_heg(:,:,:),
     &                           sig_k_omega_vertex_heg(:,:,:),
     &                           sigc0_k_om_heg(:,:,:),
     &                           theta_q_nu_heg(:,:),
     &                           theta_r_tau(:,:),
     &                           vrt3s_cur_heg(:,:,:),
     &                           vrt3s_heg(:,:)
      end
  