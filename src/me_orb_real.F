      subroutine me_orb_real
	use atom_mod
	use manager_mod
      implicit none
	integer :: l,m1,ma1,m,ma
	complex*16 :: a,b,c
      allocate(orb_mom_real(-maxb:maxb,-maxb:maxb,0:maxb,3))
      orb_mom_real=(0.d0,0.d0)
      do l=0,maxb
        do m1=-l,l
          ma1=abs(m1)
          do m=-l,l
            ma=abs(m)
            a=(0.d0,0.d0)
            b=(0.d0,0.d0)
            c=(0.d0,0.d0)
            if(m<0.and.m1<0) then
c ------------------------ L(-) ------------------------------------
              if(m==m1-1) a=a-0.5d0*sqrt(dfloat(l+m1)*(l-m1+1))
              if(ma==ma1-1) a=a-0.5d0*(-1)**(m+m1)*
     &                             sqrt(dfloat(l+ma1)*(l-ma1+1))
c ------------------------ L(+) ------------------------------------
              if(m==m1+1) b=b-0.5d0*sqrt(dfloat(l+m1+1)*(l-m1))
              if(ma==ma1+1) b=b-0.5d0*(-1)**(m+m1)*
     &                             sqrt(dfloat(l+ma1+1)*(l-ma1))
c ------------------------ L(z) ------------------------------------
            else if(m==0.and.m1<0) then
c ------------------------ L(-) ------------------------------------
              if(m1==-1) a=a+(0.d0,1.d0)*sqrt(dfloat(l+1)*l/2.d0)
c ------------------------ L(+) ------------------------------------
              if(m1==-1) b=b+(0.d0,1.d0)*sqrt(dfloat(l)*(l+1)/2.d0)
c ------------------------ L(z) ------------------------------------
            else if(m>0.and.m1<0) then 
              if(-m==m1-1) a=a+(0.d0,0.5d0)*sqrt(dfloat(l+m1)*(l-m1+1))
              if(m==ma1-1) a=a-(0.d0,0.5d0)*(-1)**(m+m1)*
     &                             sqrt(dfloat(l+ma1)*(l-ma1+1))
c ------------------------ L(+) ------------------------------------
              if(-m==m1+1) b=b+(0.d0,0.5d0)*sqrt(dfloat(l+m1+1)*(l-m1))
              if(m==ma1+1) b=b-(0.d0,0.5d0)*(-1)**(m+m1)*
     &                             sqrt(dfloat(l+ma1+1)*(l-ma1))
c ------------------------ L(z) ------------------------------------
              if(-m==m1) c=c-(0.d0,1.d0)*m1 
            else if(m<0.and.m1==0) then
c ------------------------ L(-) ------------------------------------
              if(m==-1) a=a+(0.d0,1.d0)*sqrt(dfloat(l+1)*l/2.d0)
c ------------------------ L(+) ------------------------------------
              if(m==-1) b=b+(0.d0,1.d0)*sqrt(dfloat(l)*(l+1)/2.d0)
c ------------------------ L(z) ------------------------------------
            else if(m==0.and.m1==0) then
c ------------------------ L(-) ------------------------------------
c ------------------------ L(+) ------------------------------------
c ------------------------ L(z) ------------------------------------
            else if(m>0.and.m1==0) then
c ------------------------ L(-) ------------------------------------
              if(m==1) a=a+sqrt(dfloat(l+1)*l/2.d0)
c ------------------------ L(+) ------------------------------------
              if(m==1) b=b-sqrt(dfloat(l)*(l+1)/2.d0)
c ------------------------ L(z) ------------------------------------
            else if(m<0.and.m1>0) then 
              if(m==-m1-1) a=a+(0.d0,0.5d0)*sqrt(dfloat(l-m1)*(l+m1+1))
              if(ma==m1-1) a=a-(0.d0,0.5d0)*(-1)**(m+m1)*
     &                             sqrt(dfloat(l+m1)*(l-m1+1))
c ------------------------ L(+) ------------------------------------
              if(m==-m1+1) b=b+(0.d0,0.5d0)*sqrt(dfloat(l-m1+1)*(l+m1))
              if(ma==m1+1) b=b-(0.d0,0.5d0)*(-1)**(m+m1)*
     &                             sqrt(dfloat(l+m1+1)*(l-m1))
c ------------------------ L(z) ------------------------------------
              if(m==-m1) c=c-(0.d0,1.d0)*m1
            else if(m==0.and.m1>0) then
c ------------------------ L(-) ------------------------------------
              if(m1==1) a=a-sqrt(dfloat(l+1)*l/2.d0)
c ------------------------ L(+) ------------------------------------
              if(m1==1) b=b+sqrt(dfloat(l)*(l+1)/2.d0)
c ------------------------ L(z) ------------------------------------
            else if(m>0.and.m1>0) then
c ------------------------ L(-) ------------------------------------
              if(m==m1+1) a=a+0.5d0*sqrt(dfloat(l-m1)*(l+m1+1))
              if(m==m1-1) a=a+0.5d0*(-1)**(m+m1)*
     &                             sqrt(dfloat(l+m1)*(l-m1+1))
c ------------------------ L(+) ------------------------------------
              if(m==m1-1) b=b+0.5d0*sqrt(dfloat(l-m1+1)*(l+m1))
              if(m==m1+1) b=b+0.5d0*(-1)**(m+m1)*
     &                             sqrt(dfloat(l+m1+1)*(l-m1))
c ------------------------ L(z) ------------------------------------               
            endif
            orb_mom_real(m,m1,l,1)=a
            orb_mom_real(m,m1,l,2)=b
            orb_mom_real(m,m1,l,3)=c
          enddo
        enddo
      enddo
      end