      module solid_mod
	  logical :: iheg,
     &           invers,
     &           metal,
     &	         symmorph
      character*2 :: chi_basis
	  character*80 :: symgen
	  integer :: band_interp,
     &           ind_tens33(3,3),
     &           inv,
     &	         inv_num,
     &           istruc,
     &           k_irrep_max,
     &           k_small_sphere,
     &           k_star_max,
     &           max_r_inv,
     &           max_r_star,
     &           max_sites,
     &           maxfgtl,
     &           maxia,
     &           maxib,
     &           maxic,
     &           maxnsym,
     &           maxnsymb,
     &           maxplw,
     &           maxplwro,
     &           maxra,
     &           maxrb,
     &           maxrc,
     &           maxstar,
     &           maxwig,
     &           maxwig_j,
     &           mdiv(3),
     &           mdiv_c(3),
     &           mdivs(3),
     &           mmm,
     &           mmms,
     &           n_block_k_max,
     &           n_gamma,
     &           n_int_g_pair,
     &           n_k_div,
     &           n_k_head,
     &           n_k_head_0,
     &           n_k_int(3),
     &           n_k_ph,
     &           n_line,
     &           n_opt_pb,
     &           n_phead_dir,
     &           n_rr_max,
     &           n_semic,
     &           n_sym,
     &           n_symb,
     &           nat_sort_max,
     &           natom,
     &           nbasm,
     &           nbasmpw,
     &           nbnd_plot,
     &           nbndf,
     &           nbndf_bnd,
     &           nbndf_bnd_0(2),
     &           nbndf_ubn,
     &           nbndf_wan,
     &           nbndtm,
     &           nbndtmi,
     &           ndeg_max,
     &           ndiv(3),
     &           ndos,
     &           ndtau,
     &           neighbour_3_max,
     &           nfgtl,
     &           ngroup,
     &           nkd,
     &           nkr,
     &           nn_k_int,
     &           nn_shells,
     &           nplw_gw,
     &           nplwbas,
     &           nplwdif,
     &           nplwdif_pb,
     &           nplwpb,
     &           nplwro,
     &           nplwrop,
     &           npnt,
     &           nqdiv,
     &           nr_full,
     &           nr_full_inv,
     &           nr_red,
     &           nrdiv(3),
     &           nrr_max,
     &           nsort,
     &           nstar,
     &           nstar_r,
     &           ntcorr,
     &           num_dif_tt,
     &           num_k_path,
     &           num_k_plot,
     &           num_neighbour_max,
     &           numplw,
     &           numvol,
     &           t_minus_t_num,
     &           t_minus_t_num_c,
     &           tt_minus_tt_num,
     &           tt_minus_tt_num_c,
     &           z_fit
      real*8 :: aa00_0z,
     &          adm_sig,
     & 	        akmax,
     &	        amega,
     &          amegaint,
     &	        b_a,
     &          c_a,
     &          cut_gw_ratio,
     &          cut_rr,
     &          cut_vrt_ratio,
     &          cutoff,
     &          cutoff_g_all,
     &          cutoffro,
     &          e_b_ext,
     &          efermi,
     &          emindos,
     &          emaxdos,
     &          ewald,
     &          hovb,
     &          logq_aver,
     &          logq_aver_c,
     &          lucb,
     &          mu_coul_pspot(2),
     &          q0b0(3,3),
     &          q0aver,
     &          q0aver_c,
     &          q1aver,
     &          q1aver_c,
     &          q2aver,
     &          q2aver_c,
     &          qb0(3,3),
     &          gbas(3,3),
     &          gbar_param,
     &          magnet_o(3),
     &          magnet_s(3),
     &          molar_mass,
     &          par,
     &          p_q0_vrt(0:1),
     &	        q_max_ref,
     &          r_max_g_pair,
     &          r0b0(3,3),
     &          rb0(3,3),
     &          rbas(3,3),
     &          step_q_long,
     &          v_gg_11,
     &          v_v0
	  character*1, allocatable :: k_label(:,:),
     &                            sym_label(:),
     &                            sym0_label(:)		
	  integer, allocatable :: atom_nn(:,:),
     &                        entry_block_k(:,:,:),
     &	                      g_sym_0(:,:),
     &	                      gbs_sym(:,:),
     &                        gtild_sym_k(:,:),
     &	                      i_kref(:),
     &                        i_r_inv(:),
     &	                      iafm(:),
     &	                      iat_1(:),
     &	                      iat_sort(:,:),
     &	                      iat_sort_back(:),
     &	                      iat_tel(:),
     &	                      ifia(:),
     &                        ig_pair(:,:,:),
     &                        ig_pair_cor(:,:,:,:),
     &	                      igbs(:,:),
     &                        igbsf(:),
     &                        igbsfw(:),
     &                        ind_bands_bnd(:,:,:),
     &                        ind_bands_ubn(:,:,:),
     &                        ind_bands_wan(:,:,:),
     &                        ind_block_k(:,:,:),
     &                        ind_class_k(:,:),
     &	                      ind_dif_tt(:,:),
     &                        ind_k_star_back(:),
     &                        ind_r_inv(:,:),
     &                        ind_r_star(:,:),
     &                        ind_r_star_back(:),
     &                        ind_rsp(:,:,:),
     &                        indback(:,:,:,:,:),
     &	                      indbas(:,:,:),
     &                        index_k1(:),
     &                        indfgtl(:,:),
     &                        indgb(:,:),
     &                        indgb_plot(:,:),
     &                        indplw(:,:,:),
     &                        indpw_gw(:,:),
     &                        indstar(:),
     &                        indstar_r(:),
     &                        ip(:,:),
     &                        ip_k(:,:),
     &                        ip_r(:,:),
     &                        ip_r_inv(:,:),
     &                        ip_r_star(:,:,:),
     &                        ipdtau(:,:),
     &                        iplf_bk(:,:),
     &                        iplf_gk(:,:),
     &                        ir_ref(:),
     &	                      irbs(:,:),
     &	                      iref_k_small_sphere(:),
     &	                      is(:),
     &	                      iso_tel(:),
     &                        itshift_r(:,:,:),
     &                        k_group(:),
     &                        kk_group(:,:),
     &                        k_list(:,:),
     &                        k_npnt_in_line(:),
     &                        k_npnt_in_sym(:),
     &                        k_small_sphere_map(:),
     &                        k_star(:),
     &                        k_sym_0(:,:),
     &                        k_tetr0(:,:),
     &                        k_tetr1(:,:),
     &                        k_tetr2_0(:),
     &                        khead(:,:),
     &                        khead0(:),
     &                        kline_in_npnt(:),
     &                        ksym_in_npnt(:),
     &                        last_block_k(:,:,:),
     &                        lastg(:),
     &                        lat_nn(:,:),
     &                        list_sym_k(:,:),
     &                        list_sym_k0(:,:),
     &                        lmsym(:,:),
     &                        lmsymb(:,:,:),
     &                        n_block_k(:,:),
     &                        n_bnd(:,:),
     &                        n_class_k(:),
     &                        n_ig_pair_cor(:,:,:),
     &                        n_low_bnd(:,:),
     &                        n_low_ubn(:,:),
     &                        n_low_wan(:,:),
     &                        nbask(:),
     &                        nbask_plot(:),
     &                        neighbour_3(:,:),
     &                        neighbours_direct(:,:),
     &                        nfun_els_adr(:,:,:),
     &                        nfun_ls_adr(:,:),
     &                        nfun_order(:),
     &                        nfun_order_back(:),
     &                        nhsort(:),
     &                        nk_group(:),
     &                        nn_sites(:),
     &                        nplwgw(:),
     &                        nr_full_ind(:),
     &                        nrr_red(:,:),
     &                        nrr_red_cor(:,:),
     &                        nsym(:),
     &                        nsymb(:),
     &                        num_neighbour(:),
     &                        num_r_inv(:),
     &                        num_r_star(:),
     &                        num_sym_k(:),
     &                        num_sym_k0(:),
     &                        r_group(:),
     &                        r_pnt(:,:),
     &                        r_pnt_ind(:),
     &                        r_stars_based(:),
     &                        r0_pair(:,:,:),
     &                        r0_pair_cor(:,:,:),
     &	                      rr_pnt_c(:,:),
     &                        t_minus_t(:,:),
     &                        t_minus_t_c(:,:),
     &                        tt_minus_tt(:,:),
     &                        tt_minus_tt_c(:,:),
     &                        three_site_neighbours(:,:,:),
     &                        u_inv(:),
     &                        u_prod(:,:),
     &	                      wan_bands(:,:,:)
	  logical, allocatable :: sym(:,:),
     & 	                      symb(:,:,:)
      real*8, allocatable :: ag(:,:,:),
     &	                     agm(:,:,:),
     &                       agtlr(:,:,:),
     &                       agtli(:,:,:),
     &                       bgtlr(:,:,:),
     &                       bgtli(:,:,:),
     &                       bm_coef_r(:,:),
     &                       cell_form(:,:,:),
     &                       cgtlr(:,:,:),
     &                       cgtli(:,:,:),
     &                       coef_d_tetr(:,:),
     &                       de_bnd(:,:,:,:),
     &                       dif_tt(:,:),
     &                       dlat(:,:),
     &                       dtau(:,:),
     &                       e_bnd(:,:,:),
     &                       e_lda(:,:,:),
     &	                     e_output(:,:),
     &                       e_plot(:,:,:),
     &                       e_qp(:,:,:),
     &                       e_wan(:,:,:),
     &                       em1_gg0(:,:),
     &                       em1_gg0_tau(:,:),
     &                       fgtlr(:,:,:),
     &                       fgtli(:,:,:),
     &                       force_matr(:,:,:,:),
     &	                     g_full(:,:,:,:,:,:),
     &	                     g_full_00(:,:,:),
     &	                     g_rr_wan(:,:,:,:,:,:),
     &	                     g_rr_wan_0(:,:,:,:),
     &	                     gbs(:,:),
     &	                     gc_k_omega(:,:,:,:,:,:),
     &	                     gx_rr_wan(:,:,:,:,:,:),
     &                       k_dist(:),
     &                       k_int_vec(:,:),
     &                       k_plot(:,:),
     &                       kpath_len(:),
     &	                     magn_shift(:),
     &	                     mi0(:,:),
     &                       mi0_b(:,:),
     &	                     mi4(:,:),
     &                       p_0z_ii(:,:,:),
     &                       p_0z_mi(:,:,:,:),
     &                       p_0z_mm(:,:,:),
     &                       p_delta(:,:,:,:),
     &                       p_head_all(:,:),
     &                       p_head_tau(:,:),
     &                       p_w_q_tau_ii(:,:,:),
     &                       p_w_q_tau_mi(:,:,:,:),
     &                       p_w_q_tau_mm(:,:,:),
     &                       p_wing_all(:,:,:),
     &                       ph_dir(:,:),
     &                       pl_ll(:,:,:,:),
     &	                     p_output(:,:),
     &                       p_nu0(:,:,:),
     &	                     pnt(:,:),
     &	                     pnt_1bz(:,:),
     &	                     pnt_1bz_c(:,:),
     &	                     pv(:,:,:,:),
     &                       pvj(:,:,:),
     &                       pw_pb_r(:,:),
     &                       pw_pb_tild_r(:,:),
     &                       pw_sclp(:,:,:,:),
     &                       pw_expan0(:,:,:,:,:),
     &                       pz_sclp(:,:,:,:),
     &                       q_line(:,:),
     &                       q_sym(:,:),
     &                       qp_spectr_weight(:,:,:),
     &	                     rbs(:,:),
     &                       rcosph(:),
     &                       rcostar(:),
     &                       rcostar_r(:),
     &	                     ri(:),
     &                       rlat(:,:),
     &                       ro_rs(:,:),
     &                       rr(:),
     &                       rr_3(:,:),
     &                       rr_pnt(:,:),
     &                       s_it_r0(:,:,:),
     &                       shift(:,:),
     &                       sig_2_omega(:,:,:,:,:,:),
     &                       sig_3_omega(:,:,:,:,:,:),
     &                       sig_c_tau(:,:,:,:,:,:),
     &                       sig_c_tau_old(:,:,:,:,:,:),
     &                       sig_qp_eff(:,:,:,:),
     &                       sig_sc_x_bnd(:,:,:,:),
     &                       sovr(:),
     &                       sovi(:),
     &	                     surf_two_site(:,:,:,:,:),
     &	                     tau(:,:),
     &                       tshift(:,:,:),
     &                       tshift_r(:,:,:),
     &                       u(:,:),
     &                       u_atom(:,:,:,:,:,:,:),
     &                       u_atom_old(:,:,:,:,:,:,:),
     &                       u_opt(:,:,:),
     &                       unit_vect_sphere(:,:),
     &                       vatmt(:,:),
     &                       v_ii_3(:,:),
     &                       v_ii_3_sr(:,:),
     &                       v_mi_3(:,:,:),
     &                       v_mi_3_sr(:,:,:),
     &                       v_mm_3(:,:),
     &                       v_mm_3_sr(:,:),
     &	                     v_mt_1(:,:,:),
     &                       v_opt_e(:),
     &                       w_head_dir(:),
     &	                     w_output(:,:),
     &	                     w_rs_mi(:,:,:),
     &	                     w_rs_mm(:,:,:),
     &                       war(:,:),
     &                       warb(:,:),
     &                       warbi(:,:),
     &                       wari(:,:),
     &                       wgt(:),
     &                       wgt_sphere(:),
     &                       ws01_met_r(:),
     &                       ws_head(:),
     &                       ws_head_nu(:),
     &                       ws_head_tens_r(:,:,:),
     &                       ws_wing_r(:,:,:),
     &                       xi_0_q_tau(:,:,:,:,:),
     &                       xx_stat(:,:,:,:),
     &                       ylm_sphere(:,:)
	  complex*16, allocatable :: a_irrep_k(:,:,:,:),
     &                           aa01_0z(:),
     &                           atm_proj(:,:,:,:,:),
     &                           b_intr(:,:),
     &                           bm_coef(:,:),
     &                           c_pol_reg(:),
     &                           delta_hybr(:,:,:,:,:),
     &	                         e_gw(:,:,:),
     &	                         ev_bnd(:,:,:,:),
     &	                         g_full_0(:,:,:,:),
     &	                         g_k_wan(:,:,:,:,:,:),
     &	                         g_loc_0(:,:,:,:),
     &	                         m_p_overl(:,:,:,:,:),
     &	                         m_pw_long(:,:),
     &	                         m_pw_tild_long(:,:),
     &                           p_head_0z(:,:,:),
     &                           p_head_dft(:,:,:),
     &                           p_head_rsp(:,:,:),
     &                           p_wing_0z(:,:,:),
     &                           p_wing_dft(:,:,:),
     &                           p_wing_rsp(:,:,:),
     &                           p_solid_k_nu(:,:,:,:),
     &                           pgg(:,:,:),
     &                           pl_ll_c(:,:,:,:),
     &                           pl_llr(:,:,:),
     &	                         pv_x(:,:,:),
     &                           pvg(:,:,:),
     &                           pvv(:,:,:),
     &                           pw_expan(:,:),
     &                           pw_pb(:,:),
     &                           pw_pb_tild(:,:),
     &                           pw_ptn(:,:),
     &                           q_qp(:,:,:,:),
     &                           rointr(:,:),
     &                           sa(:,:,:,:,:),
     &                           sig_c_pade_a(:,:,:,:,:),
     &                           sig_gw_ren_omega(:,:,:,:,:),
     &                           sigx_solid_k(:,:,:),
     &                           sigx_solid_k_old(:,:,:),
     &                           spintr(:,:),
     &	                         uj(:,:),
     &	                         uujj(:,:,:,:,:),
     &                           v_h_bb(:,:,:),
     &                           v_h_bb_old(:,:,:),
     &                           v_intr_h(:),
     &                           v_intr_xc(:,:),
     &                           v_xc_bb(:,:,:),
     &                           v_xc_bb_old(:,:,:),
     &                           w_c_tau(:,:,:,:),
     &                           ws_head_tens(:,:,:),
     &                           ws_wing(:,:,:),
     &                           ws01_met(:),
     &                           z_bnd(:,:,:,:),
     &                           z_gw_left(:,:,:,:),
     &                           z_gw_right(:,:,:,:),
     &                           z_qp(:,:,:,:)
      end
